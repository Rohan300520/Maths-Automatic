<!doctype html>
<html lang="en">
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
		<!--link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"-->
		<!-- jQuery library -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
		<script>
			MathJax.Hub.Config({
				tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
			});
		</script>
		<!-- Latest compiled JavaScript -->	
		<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
		<script src="{{ url_for('static', filename='bower_components/mathlive/dist/mathlive.min.js') }}"></script>
		<script src="{{ url_for('static', filename='bower_components/drawingboard.js/dist/drawingboard.js') }}"></script>
        <script src="{{ url_for('static', filename='bower_components/simple-undo/lib/simple-undo.js') }}"></script>
		<link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='bower_components/drawingboard.js/dist/drawingboard.min.css') }}"/>
		<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Rancho" />
		<style>
			.overlay {
				position: fixed;
				top: 0;
				bottom: 0;
				left: 0;
				right: 0;
				background: rgba(0, 0, 0, 0.7);
				transition: opacity 500ms;
				visibility: hidden;
				opacity: 0;
			}
			.overlay:target {
				visibility: visible;
				opacity: 1;
			}
			.popup {
				margin: 70px auto;
				padding: 10px;
				background: yellow;
				border-radius: 5px;
				width: 50%;
				position: relative;
				transition: all 5s ease-in-out;
			}

			.popup h2 {
				margin-top: 0;
				color: #333;
				font-family: Tahoma, Arial, sans-serif;
			}
			.popup .close {
				position: absolute;
				top: 20px;
				right: 30px;
				transition: all 200ms;
				font-size: 30px;
				font-weight: bold;
				text-decoration: none;
				color: #333;
			}
			.popup .close:hover {
				color: #06D85F;
			}
			.popup .content {
				max-height: 30%;
				overflow: auto;
			}
			.box {
				width: 50%;
				margin: 0 auto;
				background: rgba(255,255,255,0.2);
				padding: 10px;
				border: 2px solid #fff;
				border-radius: 20px/50px;
				background-clip: padding-box;
				text-align: center;
			}
			@media screen and (max-width: 700px){
				.box{
					width: 70%;
				}
				.popup{
					width: 70%;
				}
			}
			#uploadButton {
				display: inline-flex;
				align-items: center;
				justify-content: center;
				padding: 8px 12px;
				border: 1px solid #ccc;
				cursor: pointer;
			}

			#uploadButton:hover {
				background-color: #f5f5f5;
			}
		</style>
	</head>
	<body>
		<header>
			<!-- Navbar -->
			<nav class="navbar navbar-expand-lg navbar-light bg-light">
				<b><a class="navbar-brand" href="#" style="color:#8b008b;">Math's Automatic</a></b>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarText">
					<ul class="navbar-nav ml-auto">
						<li class="nav-item active">
							<a class="nav-link" href="#example">Examples</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#about">About</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/logout">Logout</a>
						</li>
					</ul>
				</div>
			</nav>
			
		</header>
		<section>
			<div class = "container-fluid">
				<div class="container-fluid" style="background-image:url('static/images/3.1.png') ; width: 100%;background-size: contain;">
					<div class="row p-5">
						<div class="col text-center" ><h1>Get step-by-step</br>solution to</br>math problems</h1></div>
						<div class="col"><img src = "{{ url_for('static', filename='images/mainpage2.png') }}" width = "100%"></div>
					</div>
				</div>
			</div>
			<div class = "container-fluid align-items-center" id = "all" >	
				<div class ="container align-items-center" style="background:#fff;border-radius: 5px;border: 3px solid rgba(0, 0, 0, .3);">
					<div class ="container text-center">
						
						<h5><b><p style="color:#AA02A3;text-align: center;margin-top: 3em; font-family: Rancho;" id="speech_text"></p></b></h5>
						<span id = "speech_gif"><img src = "{{ url_for('static', filename='images/voice.gif') }}" height = "40px" width = "100px"></span>
					</div>
					<div class = "container align-items-center row">
						<div class="col-sm-9" style = "background-color:#E8CDFD ;border-radius: 8px;padding:5px;">
							<span>
								<math-field id="mf" virtual-keyboard-mode="manual" onfocus = "mathfield()"style="
									font-size: 25px; 
									padding: 5px; 
									border-radius: 8px;
									border: 1px solid rgba(0, 0, 0, .3); 
									box-shadow: 0 0 8px rgba(0, 0, 0, .2);
									background:  #fff;
								"></math-field>
							</span>
						</div>
						<div class="col-sm-1 pull-left" style="padding:0px; ">
							<button class="btn btn-transparent rounded-circle" style="background-color:#7AD7F0;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);" id = "mike">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-mic" viewBox="0 0 16 16" >
									<path d="M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5z"/>
									<path d="M10 8a2 2 0 1 1-4 0V3a2 2 0 1 1 4 0v5zM8 0a3 3 0 0 0-3 3v5a3 3 0 0 0 6 0V3a3 3 0 0 0-3-3z"/>
								</svg>
							<i class="bi bi-mic"></i>
							</button>
						</div>
						<div class="col-sm-1 pull-left">
							<input type="file" id="fileInput" accept=".png, .jpg" style="display: none;">
							<label for="fileInput" id="uploadButton" class = "btn">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16">
								<path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
								<path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
							</svg>
							</label>
						</div>
						<div class ="col-sm-1">
							<button class ="btn rounded-pill bg-success text-white" style="background-color: #E8CDFD;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);" onclick = "solve()">
							<b>Solve</b></button>
						</div>
					</div>
					<div class="container" id="board1" style="">
						<div class="container align-items-center board"  style="border: 1px solid rgba(0, 0, 0, .3); box-shadow: 0 0 8px rgba(0, 0, 0, .2);border-radius: 8px; margin-top: 1em;">
							<span class ="text-center" id = "error"><h6 style = "color:red">Could not recognize the equation , please see <a href = "#popup1">hints</a></h6></span>
							<div class="container" id="zbeubeu" style="height:410px;margin:0.5"></div>
						</div>
					</div>
					<div class="container">
						<div id="popup1" class="overlay">
							<div class="popup">
								<h2>HINT</h2>
									<a class="close" href="#">&times;</a>
										<div class="content">
											<p><b>Recognised symbols are:</b> {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, a, b, c, m, n, x, y, z, +, -, &horbar;, &lowast;, ., &radic;, =, &ne;, {, }, [, ], (, )}</p>
												<p>
													<ul><b>Important instructions:</b></ul>
														<li>To perform multiplication operation use &lowast; symbol</li>
														<li>To perform division operation use &horbar; bar fraction symbol</li>
														<li>Each symbol must be written separately - symbols must not be connected</li>
														<ul><b>Math conventions:</b></ul>
														<li>
															Don't write the fraction bar with a width less than the numerator or denominator
														</li>
													</ul>
													</ul>
												</p>
										</div>
							</div>
						</div>
					</div>
					<div class="text-center"><a href="#all">
						<button class ="btn btn-transparent" onclick="myFucnction()" id = "btn1">
							<svg width="271" height="45" viewBox="0 0 271 45" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path d="M137.134 44.6079C136.06 44.8656 134.94 44.8656 133.866 44.6079L5.53178 13.8067C-2.53327 11.871 -1.12871 0 7.16538 0H263.835C272.129 0 273.533 11.871 265.468 13.8067L137.134 44.6079Z" fill="#E8CDFD"/>
									<image x="120" y="4" href="{{ url_for('static', filename='images/fountain-pen-close-up.png') }}" height="35" width="35"/>
							</svg>
						</button></a>
					</div>
					<div class="container align-items-center">
â€‹						<div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
							<div class="carousel-inner">
    
								<div class="carousel-item active" style="margin-bottom:1em;">
									<div class="container row">
										<div class="col-sm-4 text-center" style="border-radius: 15px;border: 3px solid rgba(0, 0, 0, .3);border-color:#E8CDFD;cursor: pointer;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);">
											<button style="border:none;background-color:transparent" onclick="function1()">
												<div class="container" style="margin-top:2em;margin-bottom:2em;">
													<h6><b>\begin{equation*} (a+b)^2 \end{equation*}</b></h6>
												</div>
											</button>
										</div>
										<div class="col-sm-4 text-center" style="border-radius: 15px;border: 3px solid rgba(0, 0, 0, .3);border-color:#E8CDFD;cursor: pointer;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);">
											<button style="border:none;background-color:transparent" onclick="function2()">
												<div class="container" style="margin-top:2em;margin-bottom:2em;">
													<h6><b>\begin{equation*} x^2-4x+5 \end{equation*}</b></h6>
												</div>
											</button>
										</div>
										<div class="col-sm-4 text-center" style="border-radius: 15px;border: 3px solid rgba(0, 0, 0, .3);border-color:#E8CDFD;cursor: pointer;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);">
											<button style="border:none;background-color:transparent" onclick="function3()">
												<div class="container" style="margin-top:2em;margin-bottom:2em;">
													<h6><b>\begin{equation*} 4\sin\theta2\cos\theta \end{equation*}</b></h6>
												</div>
											</button>
										</div>
									</div>
								</div>
								<div class="carousel-item" style="margin-bottom:1em;">
									<div class="container row" >
										<div class="col-sm-4 text-center " style="border-radius: 15px;border: 3px solid rgba(0, 0, 0, .3);border-color:#E8CDFD;cursor: pointer;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);">
											<button style="border:none;background-color:transparent" onclick="function4()">
												<div class="container" style="margin-top:2em;margin-bottom:2em;">
													<h6><b>\begin{equation*} 655\times599 \end{equation*}</b></h6>
												</div>
											</button>
										</div>
										<div class="col-sm-4 text-center" style="border-radius: 15px;border: 3px solid rgba(0, 0, 0, .3);border-color:#E8CDFD;cursor: pointer;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);">
											<button style="border:none;background-color:transparent" onclick="function5()">
												<div class="container" style="margin-top:2em;margin-bottom:2em;">
													<h6>\begin{equation*} \int\sqrt{5+2x}\mathrm{d}x \end{equation*}</h6>
												</div>
											</button>
										</div>
										<div class="col-sm-4 text-center" style="border-radius: 15px;border: 3px solid rgba(0, 0, 0, .3);border-color:#E8CDFD;cursor: pointer;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);">
											<button style="border:none;background-color:transparent" onclick="function6()">
												<div class="container" style="margin-top:2em;margin-bottom:2em;">
													<h6><b>\begin{equation*} y=x+\sqrt{x} \end{equation*}</b></h6>
												</div>
											</button>
										</div>
									</div>
								</div>
								<div class="carousel-item" style="margin-bottom:1em;">
									<div class="container row">
										<div class="col-sm-4 text-center" style="border-radius: 15px;border: 3px solid rgba(0, 0, 0, .3);border-color:#E8CDFD;cursor: pointer;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);">
											<button style="border:none;background-color:transparent" onclick="function7()">
												<div class="container" style="margin-top:2em;margin-bottom:2em;">
													<h6><b>\begin{equation*} \log_5x=3 \end{equation*}</b></h6>
												</div>
											</button>	
										</div>
										<div class="col-sm-4 text-center" style="border-radius: 15px;border: 3px solid rgba(0, 0, 0, .3);border-color:#E8CDFD;cursor: pointer;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);">
											<button style="border:none;background-color:transparent" onclick="function8()">
												<div class="container" style="margin-top:2em;margin-bottom:2em;" >
													<h6><b>\begin{equation*} lcm(12,45) \end{equation*}</b></h6>
												</div>
											</button>
										</div>
										<div class="col-sm-4 text-center" style="border-radius: 15px;border: 3px solid rgba(0, 0, 0, .3);border-color:#E8CDFD;cursor: pointer;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);">
											<button style="border:none;background-color:transparent" onclick="function9()">
												<div class="container" style="margin-top:2em;margin-bottom:2em;">
													<h6><b>\begin{equation*} gcd(12,48) \end{equation*}</b></h6>
												</div>
											</button>
										</div>
									</div>
								</div>
							</div>
							<a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
								<span class="carousel-control-prev-icon" aria-hidden="true"></span>
								<span class="sr-only">Previous</span>
							</a>
							<a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
								<span class="carousel-control-next-icon" aria-hidden="true"></span>
								<span class="sr-only">Next</span>
							</a>
						</div>
					</div>
				</div>
				<div class = "container-fluid" id="example" style="margin:3em;width:93%;">
					<div class = "container align-items-center text-center">
						<h3>Examples</h3>
						<div class ="row">
							<div class="col bg-primary text-white" style="margin:1em;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);border-radius: 15px 50px;cursor: pointer;" id = "Arithmatic">
								<h4 style="margin:1em">Arithmatic</h4>
							</div>
							<div class="col bg-secondary text-white" style="margin:1em;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);border-radius: 15px 50px;cursor: pointer;" id = "Algebra">
								<h4 style="margin:1em">Algebra</h4>
							</div>
							<div class="col bg-info text-white" style="margin:1em;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);border-radius: 15px 50px;cursor: pointer;" id = "Calculus">
								<h4 style="margin:1em">Calculus</h4>
							</div>
						</div>
												<div class ="row">
							<div class="col" style="margin:1em;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);border-radius: 15px 50px;cursor: pointer;" id = "Differential_equation">
								<h4 style="margin:1em">Differential equation</h4>
							</div>
							<div class="col bg-warning text-dark" style="margin:1em;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);border-radius: 15px 50px;cursor: pointer;" id = "Discrete_Maths">
								<h4 style="margin:1em">Discrete Maths</h4>
							</div>
							<div class="col" style="margin:1em;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);border-radius: 15px 50px;cursor: pointer;" id = "Geometry">
								<h4 style="margin:1em">Geometry</h4>
							</div>
						</div>
						<div class ="row">
							<div class="col bg-danger text-white" style="margin:1em;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);border-radius: 15px 50px;cursor: pointer;" id = "Linear_Algebra">
								<h4 style="margin:1em">Linear Algebra</h4>
							</div>
							<div class="col bg-dark text-white" style="margin:1em;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);border-radius: 15px 50px;cursor: pointer;" id = "Statistics">
								<h4 style="margin:1em">Statistics</h4>
							</div>
							<div class="col bg-success text-white" style="margin:1em;box-shadow: 0 3px 10px rgb(0 0 0 / 0.2);border-radius: 15px 50px;cursor: pointer;" id = "Proofs">
								<h4 style="margin:1em">Proofs</h4>
							</div>
						</div>
					</div>
				</div>
				<div class="container-fluid" id="about">
					<div class="contain-fluid">
						<div class="container">
							<div class="row p-5">
								<div class="col text-center" style="margin:2em;">
									<b><h2>Recognises Simple</br>Handwritten</br>Math Equations</h2></b>
								</div>
								<div class="col">			
									<img src = "{{ url_for('static', filename='images/recognize.png') }}" width = "100%" height = "100%">
								</div>
							</div>
						</div>
					</div>
					<div class="contain-fluid">
						<div class="container" style="background-color:#e0e0e0;">
							<div class="row p-5">
								<div class="col">			
									<img src = "{{ url_for('static', filename='images/speech1.png') }}" width = "100%" height = "100%">
								</div>
								<div class="col text-center" style="margin:2em;">
									<b><h2>Allows you to</br>input math in the</br>form of speech</h2></b>
								</div>
							</div>
						</div>
					</div>
					<div class="contain-fluid">
						<div class="container">
							<div class="row p-5">
								<div class="col text-center" style="margin:2em;">
									<b><h2>Type math equations</br>using keyboard</h2></b>
								</div>
								<div class="col">			
									<img src = "{{ url_for('static', filename='images/type.png') }}" width = "100%" height = "100%">
								</div>
							</div>
						</div>
					</div>
					<div class="contain-fluid">
						<div class="container" style="background-color:#e0e0e0;">
							<div class="row p-5">
								<div class="col">			
									<img src = "{{ url_for('static', filename='images/18.png') }}" width = "50%" height = "100%" style = "margin-left: auto; margin-right: auto;">
								</div>
								<div class="col text-center" style="margin:2em;">
									<b><h2>Provides</br>Step-by-step<br>solution</br>to your math problems</h2></b>
								</div>
							</div>
						</div>
					</div>
					<div class="contain-fluid">
						<div class="container">
							<div class="row p-5">
								<div class="col text-center" style="margin:2em;">
									<b><h2>Graph your</br>Math problems</h2></b>
								</div>
								<div class="col">			
									<img src = "{{ url_for('static', filename='images/graph.png') }}" width = "100%" height = "100%">
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<footer class="bg-light text-center text-lg-start">
			<div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
				Â© 2021 Non-Copyright:
				<a class="text-dark" href=""><img src ="{{ url_for('static', filename='images/r.png') }}" style = "height:25px;width:25px;"/> </a>
			</div>
		</footer>
		<script>
			const fileInput = document.getElementById('fileInput');
			const uploadButton = document.getElementById('uploadButton');

			fileInput.addEventListener('change', (event) => {
				const file = event.target.files[0];
				if (file) {
					// Perform any additional checks or actions with the selected file if needed.
						//var img = file;
						const formData = new FormData();
      					formData.append('file', file);
						fetch('ajax1/recognize1/',{
							method: 'POST',
							body: formData,
						})
						.then(function(response) {
							return response.text()
						})
						.then(function(data) {
							data = JSON.parse(data)
							mf.value = "";
							mf.value = data.latex;
							if(data.error!=""){
								error.style.display = "block";
							}
						})
					console.log('Selected file:', file);
				}
			});
		</script>
		<script>
			var latex = "";
			var speech = "";
			const result = document.getElementById("speech_text");
			var speech_gif = document.getElementById("speech_gif");
			speech_gif.style.display = "none";
			var myBoard = new DrawingBoard.Board('zbeubeu',{
				controlsPosition:"left center"
			});
			var error = document.getElementById("error");
			error.style.display = "none";
			function mathfield(){
				result.innerHTML = "";
				x.style.display = "none";
			}
			document.getElementById("Arithmatic").onclick = function () {
				location.href = "arithmatic";
			};
			document.getElementById("Algebra").onclick = function () {
				location.href = "algebra";
			};
			document.getElementById("Calculus").onclick = function () {
				location.href = "calculus";
			};
			document.getElementById("Differential_equation").onclick = function () {
				location.href = "differentiation";
			};
			document.getElementById("Discrete_Maths").onclick = function () {
				location.href = "descretemath";
			};
			document.getElementById("Geometry").onclick = function () {
				location.href = "geometry";
			};
			document.getElementById("Linear_Algebra").onclick = function () {
				location.href = "linearalgebra";
			};
			document.getElementById("Statistics").onclick = function () {
				location.href = "statistics";
			};
			document.getElementById("Proofs").onclick = function () {
				location.href = "proofs";
			};
			document.getElementById("mike").onclick = function () {
				speech_gif.style.display = "block";
			};
			var x = document.getElementById("board1");
			x.style.display = "none";
			var mf = document.getElementById("mf");
			
			result.innerHTML=" ";
			function function1(){
				mf.value='(a+b)^2';
			}
			function function2(){
				mf.value='x^2-4x+5';
			}
			function function3(){
				mf.value='4\\sin\\theta2\\cos\\theta';
			}
			function function4(){
				mf.value='655\\times599';
			}
			function function5(){
				mf.value='\\int\\sqrt{5+2x}\\mathrm{d}x';
			}
			function function6(){
				mf.value='\y=x+\\sqrt{x}';
			}
			function function7(){
				mf.value='\\log_5x=3';
			}
			function function8(){
				mf.value='\\operatorname{lcm}(12,48)';
			}
			function function9(){
				mf.value='\\operatorname{gcd}(12,48)';
			}
			function myFucnction() {
				if (x.style.display === "none") {
					x.style.display = "block";
					myBoard.ev.bind('board:stopDrawing', why);
					function why() {
						error.style.display = "none";
						var img = myBoard.getImg();
						fetch('ajax/recognize/',{
							method: 'POST',
							headers: {
								'Accept': 'application/json',
								'Content-Type': 'application/json' },
								body: JSON.stringify({
									"image": img
								})
						})
						.then(function(response) {
							return response.text()
						})
						.then(function(data) {
							data = JSON.parse(data)
							mf.value = "";
							mf.value = data.latex;
							if(data.error!=""){
								error.style.display = "block";
							}
						})
					}
				} 
				else {
					x.style.display = "none";
				}
			}
			function solve(){
				latex = mf.value;
				if (latex != ""){
					
						sessionStorage.setItem("latex",latex);
						location.href = "solution";
					
				}
				else if(speech!=""){
					sessionStorage.setItem("latex",speech);
						location.href = "solution";
				}
				else{
					alert("No value entered");
				}
				speech_text.innerHTML = "";
				mf.value = "";
				speech = "";
				value = "";
			}
			
			window.addEventListener("DOMContentLoaded", () => {
					const button = document.getElementById("mike");
					const result = document.getElementById("speech_text");
					const main = document.getElementById("speechholder");
					var speechValue = "";
					const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition
					if (typeof SpeechRecognition === "undefined") {
						button.remove();
						const message = document.getElementById("message");
						message.removeAttribute("hidden");
						message.setAttribute("aria-hidden", "false");
						x.style.display = "none";
					} else {
						let listening = false;
						
						const recognition = new SpeechRecognition();
						const start = () => {
						recognition.start();
						x.style.display = "none";
					};
					const stop = () => {
						recognition.stop();
						speech_gif.style.display = "none";
						x.style.display = "none";
					};
					const onResult = event => {
						result.innerHTML = "";
						//for (const res of event.results) {
						//const text = document.createTextNode(res[0].transcript);
						//const p = document.createElement("p");
						//if (res.isFinal) {
						//p.classList.add("final");
						//}
						//p.appendChild(text);
						//result.appendChild(p);
			
						//}
					var transcript = event.results[0][0].transcript;
						result.innerHTML = transcript ;
						speechValue = transcript;
						speech = speechValue;
						mf.value = "";
					};
					recognition.continuous = true;
					recognition.interimResults = true;
					recognition.addEventListener("result", onResult);
  
					button.addEventListener("click", () => {
					listening ? stop() : start();
					listening = !listening;
					sessionStorage.setItem("latex",speechValue);
				});
				}
				}
			);
		</script>
	</body>
</html>